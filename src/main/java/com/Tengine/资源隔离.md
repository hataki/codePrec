# 资源隔离服务降级

## 资源隔离

what is resource isolate : 指在一个大型系统中，把不同的服务，资源，模块，组件分开；

避免单点出现故障时，导致整体服务不可用，出现集体宕机

主要隔离方式：

- ### 线程隔离

  多线程业务下，核心业务的线程和非核心业务线程分离开，

  netty本身是负载网络io的框架，if做到业务和网络隔离，它不应该和项目中业务逻辑在一起

  tomcat中资源隔离，

  servlet2.0 、 

  ![image-20210213164352826](resources\static\image\Tengine\image-20210213164352826.png)

  ![image-20210213164540763](image\Tengine\\image-20210213164540763.png)

  servlet3.0有请求隔离、 这个与nio没有关系

  tomcat6 -- 只能配置apr ，没有nio 

  **Connector**  介入连接，配置socket处理方式

  可选

  - Http11Protocol	

  - Http11NioProtocol	

  - Http11Nio2Protocol	

  - Http11AprProtocol

    

  **connector**能处理的请求比servlet的要多，同时，tomcat还加入了队列，来等待servlet线程池的空闲

  ##### ***问题***

  1. 资源一旦出现问题，虽然是隔离状态，想要让资源重新可用，很难做到不重启jvm。
  2. 线程池内部线程如果出现OOM、FullGC、cpu耗尽等问题也是无法控制的

  ##### **结论**

  线程隔离，只能保证在分配线程这个资源上进行隔离，并不能保证整体稳定性

  

  

- ### 进程隔离

- 

- ### 集群隔离

- ### 机房隔离

- ### 读写隔离

- ### 动静隔离

  参考cdn 技术

- ### 爬虫隔离

- ### 。。。





bio和nio简述：

**bio（block io，每过来一个请求时，开一个线程去处理，多个线程处理多个请求，低版本tomcat）/ nio（non-block io，采用异步方式，每当请求过来时，通过selector或者epoll来调用线程，多路复用，即少数线程处理多个请求） 基于实现的底层，在请求隔离之前已经决定了使用的是哪一个**

什么时候产生线程 --- 在对队列中实现（mq，kafka），换言之，队列其实是解决jvm中存在的问题，可以用于单体服务，通常在分布式服务中，可以发挥出更高的性能！

*最简单 资源隔离实现方式 集群式，傻瓜式的复制*

```
**服务拆分** 可以约等同于 **微服务化**
```

LB ：Load Balance 负载均衡 

大数据机房 ： 数据 +  计算  

httpdns 服务器 ，买域名服务